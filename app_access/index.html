
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dev.heureka.health/app_access/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../access_logging/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Anwendungen - dev.heureka.health</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#anwendungs-registrierung" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href=".." title="dev.heureka.health" class="md-header__button md-logo" aria-label="dev.heureka.health" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dev.heureka.health
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anwendungen
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="dev.heureka.health" class="md-nav__button md-logo" aria-label="dev.heureka.health" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    dev.heureka.health
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Über Heureka
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Zugriff
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Zugriff
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Anwendungen
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Anwendungen
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#anwendungs-registrierung" class="md-nav__link">
    <span class="md-ellipsis">
      Anwendungs-Registrierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Anwendungs-Registrierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#betriebsumgebungen" class="md-nav__link">
    <span class="md-ellipsis">
      Betriebsumgebungen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autorisierung" class="md-nav__link">
    <span class="md-ellipsis">
      Autorisierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Autorisierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zugriff-beantragen" class="md-nav__link">
    <span class="md-ellipsis">
      Zugriff Beantragen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zugriff Beantragen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#request-parameter_1" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-id" class="md-nav__link">
    <span class="md-ellipsis">
      Installation ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Token-Refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#berechtigungen-aktualisieren" class="md-nav__link">
    <span class="md-ellipsis">
      Berechtigungen Aktualisieren
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Berechtigungen Aktualisieren">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter_2" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbindung-trennen" class="md-nav__link">
    <span class="md-ellipsis">
      Verbindung Trennen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verbindung Trennen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter_3" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes_2" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-verwendung" class="md-nav__link">
    <span class="md-ellipsis">
      API Verwendung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Verwendung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-konfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      API Konfiguration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access_logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Webhooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mtls_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mTLS Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ressourcen
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#anwendungs-registrierung" class="md-nav__link">
    <span class="md-ellipsis">
      Anwendungs-Registrierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Anwendungs-Registrierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#betriebsumgebungen" class="md-nav__link">
    <span class="md-ellipsis">
      Betriebsumgebungen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autorisierung" class="md-nav__link">
    <span class="md-ellipsis">
      Autorisierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Autorisierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zugriff-beantragen" class="md-nav__link">
    <span class="md-ellipsis">
      Zugriff Beantragen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zugriff Beantragen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#request-parameter_1" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-id" class="md-nav__link">
    <span class="md-ellipsis">
      Installation ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Token-Refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#berechtigungen-aktualisieren" class="md-nav__link">
    <span class="md-ellipsis">
      Berechtigungen Aktualisieren
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Berechtigungen Aktualisieren">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter_2" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbindung-trennen" class="md-nav__link">
    <span class="md-ellipsis">
      Verbindung Trennen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verbindung Trennen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-parameter_3" class="md-nav__link">
    <span class="md-ellipsis">
      Request Parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-error-codes_2" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect Error Codes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-verwendung" class="md-nav__link">
    <span class="md-ellipsis">
      API Verwendung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Verwendung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-konfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      API Konfiguration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Anwendungen</h1>

<h2 id="anwendungs-registrierung">Anwendungs-Registrierung</h2>
<p>Um die Heureka API verwenden zu können, benötigt eine Anwendung </p>
<ul>
<li>ein gültiges mTLS Client-Zertifikat </li>
<li>eine Freigabe der verwendeten Server-IP.</li>
</ul>
<p>Ausserdem benötigt wird die Client-ID und es muss eine gültige Redirect-URI für den Authentisierungsvorgang eingerichtet sein, zudem müssen die entsprechenden <a href="../access_logging/">Request Context Parameter</a> definiert sein.</p>
<h3 id="betriebsumgebungen">Betriebsumgebungen</h3>
<p>Heureka betreibt neben dem Produktivsystem eine Testumgebung gegen welche sämtliche Entwicklungsarbeiten stattfinden sollten.</p>
<table>
<thead>
<tr>
<th>Endpunkt</th>
<th>Produktivsystem</th>
<th>Testsystem</th>
</tr>
</thead>
<tbody>
<tr>
<td>Portal / Authentisierung</td>
<td>portal.heureka.health</td>
<td>portal.testing.heureka.health</td>
</tr>
<tr>
<td>Token (mTLS)</td>
<td>token.heureka.health</td>
<td>token.testing.heureka.health</td>
</tr>
<tr>
<td>API (mTLS)</td>
<td>api.heureka.health</td>
<td>api.testing.heureka.health</td>
</tr>
</tbody>
</table>
<h2 id="autorisierung">Autorisierung</h2>
<h3 id="zugriff-beantragen">Zugriff Beantragen</h3>
<p>Die Zugriffsfreigabe findet direkt zwischen einer der Praxis zugeordneten Person (HCP) und der Heureka Anwendung statt.
Dazu bietet Heureka einen OAuth2 kompatiblen Authorization Code Flow an, mit welchem die Datenfreigabe und die damit verbundene Ausstellung der notwendigen Access-Token initiiert wird.</p>
<p>Um den Authentisierungsvorgang einzuleiten, muss der Benutzer auf folgende URL geleitet werden.</p>
<div class="highlight"><pre><span></span><code>https://portal.testing.heureka.health/authorization/grant?client_id=CLIENT_ID&amp;state=RANDOM_ANTI_CSRF_STRING&amp;redirect_uri=https://example.com/callback
</code></pre></div>
<h4 id="request-parameter">Request Parameter</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>Client ID der Anwendung</td>
</tr>
<tr>
<td>state</td>
<td>Optionales CSRF state token welches nach dem Redirect überprüft werden sollte</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>URI auf welche nach erfolgreicher oder abgelehnter Authorisierung weitergeleitet wird</td>
</tr>
</tbody>
</table>
<h4 id="redirect-error-codes">Redirect Error Codes</h4>
<p>Falls bei der Autorisierung ein Fehler auftritt, enthält die <code>redurect_uri</code> einen <code>error</code> Query-Parameter mit einem entsprechenden <a href="https://www.oauth.com/oauth2-servers/server-side-apps/possible-errors/">Fehlercode</a>.</p>
<hr />
<p>Diese öffnet den Heureka-Authentisierungsdialog, in welchem sich der Praxisbenutzer anmelden und die von der Anwendung benötigten Berechtigungen einsehen und bestätigen kann.</p>
<p>Anschliessend findet ein Redirect auf die im initialen Request angegebene Redirect-URL statt, welche den Code (Query Parameter <code>code</code>) enthält, der gegen ein kurzlebiges Access- und ein langlebiges Refresh-Token eingetauscht werden kann.</p>
<p>Der folgende und alle weiteren Aufrufe gegen die APIs von Heureka erfordern eine Authentisierung via mTLS.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>--cert<span class="w"> </span>client.crt<span class="w"> </span>--key<span class="w"> </span>client.key<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;https://token.testing.heureka.health/oauth2/token&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;grant_type=authorization_code&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;client_id=CLIENT_ID&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;redirect_uri=https://example.com/callback&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;code=AUTH_CODE&quot;</span>
</code></pre></div>
<h4 id="request-parameter_1">Request Parameter</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>Client ID der Anwendung</td>
</tr>
<tr>
<td>grant_type</td>
<td>Aktuell unterstützt wird <code>authorization_code</code></td>
</tr>
<tr>
<td>redirect_uri</td>
<td>Redirect URL die für den initialen request verwendet wurde.</td>
</tr>
<tr>
<td>code</td>
<td>Authorization code aus dem vorherigen Schritt</td>
</tr>
</tbody>
</table>
<h4 id="response">Response</h4>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;access_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJiMDI3ZmMwOS0xMjM0LTQzMjEtOGZhOS05YjM1NDJiZmJhNzEiLCJuYmYiOiIxNzI3MTg2NjkyIiwic2NvcGUiOiJbXCJvZmZsaW5lX2FjY2Vzc1wiXSIsImlzcyI6Imh0dHBzOi8vdG9rZW4udGVzdGluZy5oZXVyZWthLmhlYWx0aCIsImV4cCI6IjE3MjcxODY5OTIiLCJpYXQiOiIxNzI3MTg2NjkyIiwianRpIjoiMjgxNzBlNTQtMjA5YS00MjU0LTg3NWMtZmMwMDBlMjcwNzY2In0.Qx3XVXcOIc-h-ckLBW1hgsIJsFQUDMxiJzwwqfJihgo&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;refresh_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MTHOCCRvbVcQUQNWALfjZCqD-G9Axv8Z78fYvRxEc7RIQ7-XYZ-DnICIFH7wxE7MIcE67ejvwiHavyzbRm3V_iYvdZOZqhGctXjvo4fCwFfqo2om2-OgP132FugDw6bO&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scope&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;offline_access&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;token_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bearer&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;expires_in&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">299</span>
<span class="p">}</span>
</code></pre></div>
<pre class="mermaid"><code>sequenceDiagram
    participant u as User
    participant s as Heureka App
    participant h as Heureka
    participant a as Heureka FHIR API
    s-&gt;&gt;h: /authorization/grant request
    h-&gt;&gt;u: Authentication prompt
    u-&gt;&gt;h: Authentication and consent
    h-&gt;&gt;s: Authorization code response
    s-&gt;&gt;h: Request token using auth code &amp; mTLS certificate
    h-&gt;&gt;s: Access &amp; request token
    s-&gt;&gt;s: store request token together with installation ID (sub claim from access token)
    s-&gt;&gt;a: requests via access token &amp; mTLS certificate
    a-&gt;&gt;s: response</code></pre>
<h4 id="installation-id">Installation ID</h4>
<p>Das Access-Token enthält einen Claim <code>sub</code> welcher die <strong>Installations ID</strong> beinhaltet. Diese ID bezeichnet eindeutig die Freigabe der jeweiligen Praxis für die Anwendung und sollte anwendungsseitig zusammen mit dem Access- und Refresh-Token abgelegt werden. Die Installation ID wird wieder benötigt, um die Berechtigungs-Flows zu starten oder um Webhooks empfangen zu können.</p>
<h4 id="token-refresh">Token-Refresh</h4>
<p>Access-Tokens sind kurzlebig und müssen daher mithilfe des Refresh-Tokens nach Ablauf erneuert werden.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>--cert<span class="w"> </span>client.crt<span class="w"> </span>--key<span class="w"> </span>client.key<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;https://token.testing.heureka.health/oauth2/token&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;grant_type=refresh_token&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;client_id=CLIENT_ID&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;refresh_token=REFRESH_TOKEN&quot;</span>
</code></pre></div>
<h3 id="berechtigungen-aktualisieren">Berechtigungen Aktualisieren</h3>
<p>Beim Autorisierungsschritt erteilt der/die Benutzer:in der Anwendung Zugriff auf bestimmte Ressourcen (Bspw. Patientendaten, Medikation, etc.). Diese werden im Rahmen des Onboardings zwischen Anwendung &amp; Heureka definiert. Des Weiteren können, auch im Nachhinein, optionale Berechtigungen definiert werden, welche zusätzlich freigegeben werden können.</p>
<p>Wenn die Anwendung nachträglich zusätzliche Berechtigungen anfordern (oder abgeben) möchte ist dies möglich, indem der Benutzer auf die folgende Seite geleitet wird auf der/die Benutzer:in zusätzliche Berechtigungen vergeben oder Berechtigungen entziehen.</p>
<div class="highlight"><pre><span></span><code>https://portal.testing.heureka.health/authorization/update?installation_id<span class="o">=</span>INSTALLATION_ID<span class="p">&amp;</span><span class="nv">redirect_uri</span><span class="o">=</span>https://example.com/callback
</code></pre></div>
<h4 id="request-parameter_2">Request Parameter</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td>installation_id</td>
<td>Installation ID aus dem Access-Token</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>URI an die nach erfolgter Freigabe weitergeleitet wird</td>
</tr>
</tbody>
</table>
<h4 id="redirect-error-codes_1">Redirect Error Codes</h4>
<p>Falls bei der Autorisierung ein Fehler auftritt, enthält die <code>redurect_uri</code> einen <code>error</code> Query-Parameter mit einem entsprechenden <a href="https://www.oauth.com/oauth2-servers/server-side-apps/possible-errors/">Fehlercode</a>.</p>
<p>Wird der Vorgang abgebrochen, enthält der <code>error</code> Parameter den Wert <code>cancelled</code>.</p>
<hr />
<p>Benutzer:innen haben immer auch die Möglichkeit, via Heureka Portal einer Anwendung die Berechtigung zu entziehen.</p>
<pre class="mermaid"><code>sequenceDiagram
    participant u as User
    participant s as Heureka App
    participant h as Heureka
    s-&gt;&gt;h: /authorization/update request
    h-&gt;&gt;u: Authentication prompt
    u-&gt;&gt;h: Authentication and update grants
    h-&gt;&gt;s: Redirect to redirect_uri
    s-&gt;&gt;h: check current grants via api configuration endpoint
    h-&gt;&gt;s: response</code></pre>
<h3 id="verbindung-trennen">Verbindung Trennen</h3>
<p>Um den Benutzer:innen die Möglichkeit zu geben den Zugriff auf freigegebene Daten vollständig zu entziehen, kann auf folgende Seite weitergeleitet werden.</p>
<div class="highlight"><pre><span></span><code>https://portal.testing.heureka.health/authorization/revoke?installation_id<span class="o">=</span>INSTALLATION_ID<span class="p">&amp;</span><span class="nv">redirect_uri</span><span class="o">=</span>https://example.com/callback
</code></pre></div>
<h4 id="request-parameter_3">Request Parameter</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td>installation_id</td>
<td>Installation ID aus dem Access-Token</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>URI an die nach dem Trennen der Verbindung weitergeleitet wird</td>
</tr>
</tbody>
</table>
<h4 id="redirect-error-codes_2">Redirect Error Codes</h4>
<p>Falls bei der Autorisierung ein Fehler auftritt, enthält die <code>redurect_uri</code> einen <code>error</code> Query-Parameter mit einem entsprechenden <a href="https://www.oauth.com/oauth2-servers/server-side-apps/possible-errors/">Fehlercode</a>.</p>
<p>Wird der Vorgang abgebrochen, enthält der <code>error</code> Parameter den Wert <code>cancelled</code>.</p>
<hr />
<p>Benutzer:innen haben immer auch die Möglichkeit die Verbindung aus dem Heureka Portal zu trennen.</p>
<pre class="mermaid"><code>sequenceDiagram
    participant u as User
    participant s as Heureka App
    participant h as Heureka
    s-&gt;&gt;h: /authorization/revoke request
    h-&gt;&gt;u: Authentication prompt
    u-&gt;&gt;h: Authentication and revoke grants
    h-&gt;&gt;s: Redirect to redirect_uri</code></pre>
<h2 id="api-verwendung">API Verwendung</h2>
<p>Nachdem die Anwendung den Autorisierungsvorgang für eine Praxis erfolgreich abgeschlossen und damit ein gültiges Access-Token erhalten hat können Requests gegen die API ausgeführt werden.</p>
<p>Die Peer-to-peer Architektur von Heureka ermöglicht den direkten und sicheren Zugriff auf die Daten des Praxisinformationssystems in dem alle Anfragen via eines Proxy-Setups direkt auf das Primärsystem gelangen.</p>
<h3 id="api-konfiguration"><a name="api_configuration"></a>API Konfiguration</h3>
<p>Der API-Konfiguration-Endpunkt liefert zusammen mit der HCP-spezifischen URL für die FHIR-API auch die Proxykonfiguration zurück, welche für Requests gegen die FHIR-API verwendet werden muss.
Ausserdem enthält die API-Konfiguration die aktuell für die Installation gültigen Berechtigungen (Grants).</p>
<p>Dieser Endpunkt liefert immer die <strong>aktuell gültigen</strong> Berechtigungen für das verwendete Token zurück. Er sollte dazu verwendet werden, um sicherzustellen, dass die Awendung die erforderlichen Berechtigungen besitzt.</p>
<div class="admonition tip">
<p>Als Best Practice wird empfohlen, die gültigen Berechtigungen vor der ersten User-Interaktion zu überprüfen, um damit sicherzustellen, dass nachfolgende API-Zugriffe erlaubt sind. Auch sollte nach dem Ende des Grant-/Update-/Revoke-Flows der aktuelle Stand der Berechtigungen anhand des Endpunkts überprüft werden.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Hinweis</p>
<p>Es ist in seltenen Fällen möglich, dass eine Differenz zwischen dem Resultat des API-Konfiguration-Endpunkts und den Berechtigungen bei der Abfrage von Daten besteht, da die Berechtigungen nicht unmittelbar synchronisiert werden. Die "Source of Truth" ist in dem Fall immer der API-Konfiguration-Endpunkt und nach spätestens 60 Sekunden sollten die Systeme wieder eine einheitliche Datengrundlage haben.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fhirEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://6a5da575-6ac0-4e06-b9a5-a2210e30337c.api.testing.heureka.health/fhir&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;proxy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://tunnel.testing.heureka.health:7000&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;grants&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;PATIENT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;READ&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;SEARCH&quot;</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;MEDICATION_STATEMENT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;SEARCH&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - Heureka Health AG
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>